\documentclass[12pt]{article}
\usepackage{amsfonts}
\usepackage[hscale=.8,vscale=.8]{geometry}
\usepackage{hyperref}

\begin{document}

\title{Notes on CEV}
\date{Dec. 32, 2999}

\maketitle

\section{Fokker-Planck Equation}

  Consider the CEV process,
  \begin{equation}
    dS_t=\sigma S_t^{\beta}dW_t,
    \label{CEV}
  \end{equation}
  with $\beta < 1$, the corresponding Fokker-Planck equation is given by
  \begin{equation}
    -\frac{\partial p(t_0,s_0;t,s)}{\partial t}+\frac{1}{2}\sigma^2\frac{\partial^2}{\partial s^2}
    \left(s^{2\beta}p(t_0,s_0;t,s)\right) = 0,
    \label{FP}
  \end{equation}
  with the initial condition
  \begin{equation}
    p(t_0,s_0;t_0,s) = \delta(s-s_0),
    \label{initial}
  \end{equation}
  where $\delta(x)$ is the Dirac delta function. In the following, we will write $p(t,s)\equiv p(t_0,s_0;t,s)$.

  Define the Laplace transform of the forward transition density $p(t,s)$ as
  \begin{equation}
    p(t,s)=\int_0^{+\infty}e^{-\lambda t}g(\lambda, s)d\lambda,
    \label{Laplace}
  \end{equation}
  the Fokker-Planck equation (\ref{FP}) becomes
  \begin{equation}
    \frac{\partial^2g(\lambda,s)}{\partial s^2}+\frac{4\beta}{s}\frac{\partial g(\lambda,s)}{\partial s}
    + \left(\frac{2\lambda}{\sigma^2 s^{2\beta}}+\frac{2\beta(2\beta-1)}{s^2}\right)g(\lambda, s) = 0.
    \label{FP2}
  \end{equation}

  Following \cite{Bessel}, if $u(x)$ satisfies the Bessel equation of order $\nu$,
  \begin{equation}
    u^{\prime\prime}+\frac{1}{x}u^{\prime}+\left(1-\frac{\nu^2}{x^2}\right)u=0,
  \end{equation}
  and let $y(x)=x^au(bx^c)$, then $y(x)$ satisfies
  \begin{equation}
    y^{\prime\prime}+\frac{1-2a}{x}y^{\prime}+\left(b^2c^2x^{2c-2}+\frac{a^2-\nu^2c^2}{x^2}\right)y=0.
  \end{equation}
  Comparing the coefficients with Eq. (\ref{FP2}), we have
  \begin{equation}
    a=\frac{1}{2}\left(1-4\beta\right),\quad\quad
    b=\frac{2\nu\sqrt{2\lambda}}{\sigma}=\frac{\sqrt{2\lambda}}{\sigma(1-\beta)},\quad\quad
    c=\frac{1}{2\nu}=1-\beta,\quad\quad
    \nu=\frac{1}{2(1-\beta)}.
  \end{equation}
  Then, the general solution to Eq. (\ref{FP2}) is given by
  \begin{equation}
    g(\lambda, s)=s^{(1-4\beta)/2}\left[A_{\nu}(\lambda)J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)
                                       +B_{\nu}(\lambda)Y_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)\right],
    \label{solution}
  \end{equation}
  where $J_{\nu}(x)$ and $Y_{\nu}(x)$ are the Bessel functions of the first and second kind, respectively. To determine the
  coefficients $A_{\nu}(\lambda)$ and $B_{\nu}(\lambda)$, and subsequently the forward transition density $p(t,s)$, boundary condition
  at $s=0$ is needed. To this end, we can write down the asymptotic expansion of Eq. (\ref{solution}),
  \begin{eqnarray}
    s^{2\beta}g(\lambda,s)&\sim& \left(\left(A_{\nu}(\lambda)+B_{\nu}(\lambda)\cot(\nu\pi)\right)
                  \left(\frac{\nu\sqrt{2\lambda}}{\sigma}\right)^{\nu}s\right)\left[\frac{1}{\Gamma(1+\nu)}
              -\frac{1}{\Gamma(2+\nu)}\left(\frac{\nu\sqrt{2\lambda}}{\sigma}\right)^{2}s^{\frac{1}{\nu}}\right]\nonumber\\
              &&-\frac{B_{\nu}(\lambda)}{\sin(\nu\pi)}\left(\frac{\nu\sqrt{2\lambda}}{\sigma}\right)^{-\nu}
              \left[\frac{1}{\Gamma(1-\nu)}
              -\frac{1}{\Gamma(2-\nu)}\left(\frac{\nu\sqrt{2\lambda}}{\sigma}\right)^{2}s^{\frac{1}{\nu}}\right].
  \end{eqnarray}
  Here, we have used the series representation of the Bessel function of the first and second kind
  \begin{equation}
    J_{\nu}(x)=\sum_{m=0}^{+\infty}\frac{(-1)^m}{m!\Gamma(m+\nu+1)}\left(\frac{x}{2}\right)^{2m+\nu},
  \end{equation}
  and
  \begin{equation}
    Y_{\nu}(x)=\frac{J_{\nu}(x)\cos(\nu\pi)-J_{-\nu}(x)}{\sin(\nu\pi)}.
  \end{equation}

  Consider the Fokker-Planck equation (\ref{FP}), it can be expressed in the following current convervation form,
  \begin{equation}
    \frac{\partial p(t,s)}{\partial t} + \frac{\partial j(t,s)}{\partial s} = 0,
  \end{equation}
  with the current given by
  \begin{equation}
    j(t,s) = -\frac{1}{2}\sigma^2\frac{\partial }{\partial s}\left(s^{2\beta}p(t,s)\right).
  \end{equation}
  The common choices for the boundary condition can be either absorbing or reflective, with $j(t,s)$ being finite or
  vanishing, respectively, {\it i.e.},
  \begin{eqnarray}
    s^{2\beta}p(t,s) \sim s, && s\rightarrow 0,\quad\quad {\rm absorbing\quad boundary \quad condition}, \\
    s^{2\beta}p(t,s) \sim {\rm const.}, && s\rightarrow 0,\quad\quad {\rm reflection \quad boundary \quad condition}.
  \end{eqnarray}
  Now, consider an arbitrary function $f(s)$. From the Fokker-Planck equation (\ref{FP}), we
  have
  \begin{equation}
    \frac{\partial}{\partial t}\left(\int f(s)p(t,s)ds\right) = \frac{1}{2}\sigma^2\int f(s)\frac{\partial^2}{\partial s^2}
    \left(s^{2\beta}p(t,s)\right)ds.
  \end{equation}
  Integrating the right hand side by parts twice, we have
  \begin{eqnarray}
    \frac{\partial}{\partial t}\left(\int f(s)p(t,s)ds\right) &=& \frac{1}{2}\sigma^2\int f^{\prime\prime}(s)s^{2\beta}p(t,s)ds\nonumber \\
          && + \left . \frac{1}{2}\sigma^2\left[f^{\prime}(s)s^{2\beta}p(t,s) - f(s)\frac{\partial}{\partial s}
                \left(s^{2\beta}p(t,s)\right)\right]\right|_{s=0}.
    \label{conservation}
  \end{eqnarray}
  Let $f(s)\equiv 1$, it can be seen that the right hand side of Eq. (\ref{conservation}) does not vanish for absorbing
  boundary condition, and is zero for reflection boundary condition. Therefore, the total probability is not conserved for
  the absorbing boundary condition, and is conserved for the reflection boundary condition.

  Now consider $f(s)\equiv s$. The right hand side of Eq. (\ref{conservation}) will vanish for absorbing
  boundary condition, implying that $S_t$ is a martingale under the absorbing boundary condition, but not for reflection
  boundary condition.

  Finally, let us consider the call payoff, $f(s)=(s-K)^+$. Then, Eq. (\ref{conservation}) becomes
  \begin{equation}
    \frac{\partial}{\partial t}\left(\int f(s)p(t,s)ds\right) = \frac{1}{2}\sigma^2K^{2\beta}p(t,K),
  \end{equation}
  irrespective of the boundary condition, which gives the call option price as
  \begin{equation}
    C(t,S_t,T,K) = \int (s-K)^+p(T,s)ds = (S_t-K)^++\frac{1}{2}\sigma^2\int_t^T K^{2\beta}p(u,K)du.
  \end{equation}
  However, for the put payoff, there will be an additional boundary term for the reflection boundary condition.



\section{Absorbing boundary condition}

  The absorbing boundary condition implies that $B_{\nu}(\lambda)=0$, which leads to
  \begin{equation}
    g(\lambda, s)=s^{(1-4\beta)/2}A_{\nu}(\lambda)J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right).
  \end{equation}
  To determine the coefficient $A_{\nu}(\lambda)$, initial condition will be needed. The inverse Laplace transform of Eq.
  (\ref{Laplace}) is given by
  \begin{equation}
    p(t,s)=\int_0^{+\infty}e^{-\lambda t}g(\lambda,s)d\lambda
          =s^{(1-4\beta)/2}\int_0^{+\infty}e^{-\lambda t}
          A_{\nu}(\lambda)J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)d\lambda.
  \end{equation}
  Assuming $t_0=0$ for the moment, and set $t=0$ in the above equation, and take into account of the initial condition
  (\ref{initial}), we have
  \begin{equation}
    \delta(s-s_0)=s^{(1-4\beta)/2}\int_0^{+\infty}
          A_{\nu}(\lambda)J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)d\lambda.
  \end{equation}
  Now, multiply both sides by
  $$
    \sqrt{s}J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right),
  $$
  and integrate over $s$, we will have
  \begin{eqnarray}
      \sqrt{s_0}J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s_0^{\frac{1}{2\nu}}\right)
    &=&  \int_0^{+\infty}d\lambda^{\prime} A_{\nu}(\lambda^{\prime})
         \int_0^{+\infty}ds s^{1-2\beta}
         J_{\nu}\left(\frac{2\nu\sqrt{2\lambda^{\prime}}}{\sigma}s^{\frac{1}{2\nu}}\right)
         J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)\nonumber\\
    &=& 2\nu \int_0^{+\infty}d\lambda^{\prime} A_{\nu}(\lambda^{\prime})
         \int_0^{+\infty}du u
         J_{\nu}\left(\frac{2\nu\sqrt{2\lambda^{\prime}}}{\sigma}u\right)
         J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}u\right) \nonumber\\
    &=& 2\nu \int_0^{+\infty}d\lambda^{\prime} A_{\nu}(\lambda^{\prime})
          \frac{\displaystyle \delta\left(\frac{2\nu\sqrt{2\lambda}}{\sigma} - \frac{2\nu\sqrt{2\lambda^{\prime}}}{\sigma}\right)}
            {\displaystyle \frac{2\nu\sqrt{2\lambda}}{\sigma}}\nonumber\\
    &=& \frac{\sigma^2}{2\nu}\int_0^{+\infty}d\lambda^{\prime} A_{\nu}(\lambda^{\prime})
          \delta(\lambda - \lambda^{\prime})\nonumber\\
    &=& \frac{\sigma^2}{2\nu}A_{\nu}(\lambda).
  \end{eqnarray}
  Here, we have used the Hankel transform
  \begin{equation}
    \int_0^{+\infty}rJ_{\nu}(kr)J_{\nu}(k^{\prime}r)=\frac{\delta(k-k^{\prime})}{k},
  \end{equation}
  and the property of delta function,
  \begin{equation}
    \delta\left(f(x)\right)=\frac{\delta(x)}{|f^{\prime}(0)|}.
  \end{equation}
  Now, we have
  $$
    A_{\nu}(\lambda)=\frac{2\nu}{\sigma^2}\sqrt{s_0}J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s_0^{\frac{1}{2\nu}}\right),
  $$
  the transition density can be calculated,
  \begin{eqnarray}
    p(t,s) &=& \frac{2\nu}{\sigma^2}\left(s_0s^{1-4\beta}\right)^{1/2}\int_0^{+\infty}e^{-\lambda t}
                J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s^{\frac{1}{2\nu}}\right)
                J_{\nu}\left(\frac{2\nu\sqrt{2\lambda}}{\sigma}s_0^{\frac{1}{2\nu}}\right)d\lambda\nonumber\\
           &=& \frac{4\nu}{\sigma^2}\left(s_0s^{1-4\beta}\right)^{1/2}\int_0^{+\infty}e^{-tu^2} u
                J_{\nu}\left(\frac{\sqrt{8}\nu}{\sigma}s^{\frac{1}{2\nu}}u\right)
                J_{\nu}\left(\frac{\sqrt{8}\nu}{\sigma}s_0^{\frac{1}{2\nu}}u\right)du\nonumber\\
           &=& \frac{2\nu}{\sigma^2t}\left(s_0s^{1-4\beta}\right)^{1/2}
               \exp\left(-\frac{2\nu^2}{\sigma^2t}\left(s_0^{\frac{1}{2\nu}}+s^{\frac{1}{2\nu}}\right)\right)
               I_{\nu}\left(\frac{4\nu^2}{\sigma^2t}\left(s_0s\right)^{\frac{1}{2\nu}}\right),
  \end{eqnarray}
  where we have used the result \cite{DLMF1}
  \begin{equation}
    \int_0^{+\infty}e^{-tu^2}uJ_{\nu}(au)J_{\nu}(bu)du=\frac{1}{2t}\exp\left(-\frac{a^2+b^2}{4t}\right)I_{\nu}\left(\frac{ab}{2t}\right),
  \end{equation}
  and $I_{\nu}(x)$ is the modified Bessel function of the first kind.

  Finally, the transition density is then given by
  \begin{equation}
    p(t_0,s_0;t,s)=\frac{\left(s_0s^{1-4\beta}\right)^{1/2}}{(1-\beta)\sigma^2(t-t_0)}
    \exp\left(-\frac{s_0^{2(1-\beta)}+s^{2(1-\beta)}}{2(1-\beta)^2\sigma^2(t-t_0)}\right)
    I_{\nu}\left(\frac{\left(s_0s\right)^{1-\beta}}{(1-\beta)^2\sigma^2(t-t_0)}\right).
  \end{equation}



\section{Reflection boundary condition}

  The transition density is then given by
  \begin{equation}
    p(t_0,s_0;t,s)=\frac{\left(s_0s^{1-4\beta}\right)^{1/2}}{(1-\beta)\sigma^2(t-t_0)}
    \exp\left(-\frac{s_0^{2(1-\beta)}+s^{2(1-\beta)}}{2(1-\beta)^2\sigma^2(t-t_0)}\right)
    I_{-\nu}\left(\frac{\left(s_0s\right)^{1-\beta}}{(1-\beta)^2\sigma^2(t-t_0)}\right).
  \end{equation}


% \section{European option pricing}


% \section{Integral representation of European call option price}


% \section{SABR}


% \section{Free boundary CEV}


% \section{Free boundary SABR}





\begin{thebibliography}{99}
  \bibitem{Bessel}
    See \url{http://mathworld.wolfram.com/BesselDifferentialEquation.html}.

  \bibitem{DLMF1}
    See \url{http://dlmf.nist.gov/10.22.E67}.
\end{thebibliography}


\end{document}